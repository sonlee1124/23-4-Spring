# [2] ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ ì´í•´1 - ì˜ˆì œ ë§Œë“¤ê¸°

## 1. í”„ë¡œì íŠ¸ ìƒì„±

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/54c48e31-1de1-4384-8c34-141c3a771089/Untitled.png)

## 2. ë¹„ì§€ë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ê³¼ ì„¤ê³„

### íšŒì›

- íšŒì›ì„ ê°€ì…í•˜ê³  ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- íšŒì›ì€ ì¼ë°˜ê³¼ VIP ë‘ ê°€ì§€ ë“±ê¸‰ì´ ìˆë‹¤.
- íšŒì› ë°ì´í„°ëŠ” ìì²´ DBë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆê³ , ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ì—°ë™í•  ìˆ˜ ìˆë‹¤. (ë¯¸í™•ì •)

### ì£¼ë¬¸ê³¼ í• ì¸ ì •ì±…

- íšŒì›ì€ ìƒí’ˆì„ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤.
- íšŒì› ë“±ê¸‰ì— ë”°ë¼ í• ì¸ ì •ì±…ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.
- í• ì¸ ì •ì±…ì€ ëª¨ë“  VIPëŠ” 1000ì›ì„ í• ì¸í•´ì£¼ëŠ” ê³ ì • ê¸ˆì•¡ í• ì¸ì„ ì ìš©í•´ë‹¬ë¼. (ë‚˜ì¤‘ì— ë³€ê²½ ê°€ëŠ¥)
- í• ì¸ ì •ì±…ì€ ë³€ê²½ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤. íšŒì‚¬ì˜ ê¸°ë³¸ í• ì¸ ì •ì±…ì„ ì•„ì§ ì •í•˜ì§€ ëª»í–ˆê³ , ì˜¤í”ˆ ì§ì „ê¹Œì§€ ê³ ë¯¼ì„ ë¯¸ë£¨ê³  ì‹¶ë‹¤. ìµœì•…ì˜ ê²½ìš° í• ì¸ì„ ì ìš©í•˜ì§€ ì•Šì„ ìˆ˜ ë„ ìˆë‹¤. (ë¯¸í™•ì •)

ìš”êµ¬ì‚¬í•­ì„ ë³´ë©´ íšŒì› ë°ì´í„°, í• ì¸ ì •ì±… ê°™ì€ ë¶€ë¶„ì€ ì§€ê¸ˆ ê²°ì •í•˜ê¸° ì–´ë ¤ìš´ ë¶€ë¶„ì´ë‹¤. ê·¸ë ‡ë‹¤ê³  ì´ëŸ° ì •ì±…ì´
ê²°ì •ë  ë•Œ ê¹Œì§€ ê°œë°œì„ ë¬´ê¸°í•œ ê¸°ë‹¤ë¦´ ìˆ˜ ë„ ì—†ë‹¤. ìš°ë¦¬ëŠ” ì•ì—ì„œ ë°°ìš´ ê°ì²´ ì§€í–¥ ì„¤ê³„ ë°©ë²•ì´ ìˆì§€ ì•Šì€ê°€!

## 3. íšŒì› ë„ë©”ì¸ ì„¤ê³„

### íšŒì›

- íšŒì›ì„ ê°€ì…í•˜ê³  ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
- íšŒì›ì€ ì¼ë°˜ê³¼ VIP ë‘ ê°€ì§€ ë“±ê¸‰ì´ ìˆë‹¤.
- íšŒì› ë°ì´í„°ëŠ” ìì²´ DBë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆê³ , ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ì—°ë™í•  ìˆ˜ ìˆë‹¤. (ë¯¸í™•ì •)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/94bf0ef5-f2fa-4202-9bcf-310d71a25517/Untitled.png)

## 4. íšŒì› ë„ë©”ì¸ ê°œë°œ

### ğŸ—¨ï¸ [CoreApplication.java](http://CoreApplication.java) (ìë™ìƒì„±)

```java
package hello.core;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

// Settings > Build, Execution, Deployment > Build Tools > Gradle > IntelliJ IDEAë¡œ ë‘˜ë‹¤ ì„¤ì •
@SpringBootApplication
public class CoreApplication {

	public static void main(String[] args) {
		SpringApplication.run(CoreApplication.class, args);
	}

}
```

### ğŸ—¨ï¸ Grade.java (Enum)

```java
package hello.core.member;

public enum Grade {
    BASIC,
    VIP
}
```

### ğŸ—¨ï¸ Member.java

```java
package hello.core.member;

public class Member {
    private Long id;
    private String name;
    private Grade grade;

    public Member(Long id, String name, Grade grade) {
        this.id = id;
        this.name = name;
        this.grade = grade;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Grade getGrade() {
        return grade;
    }

    public void setGrade(Grade grade) {
        this.grade = grade;
    }
}
```

### ğŸ—¨ï¸ MemberRepository.java (Interface)

```java
package hello.core.member;

public interface MemberRepository {
    void save(Member member);
    Member findById(Long memberId);
}
```

### ğŸ—¨ï¸ MemoryMemberRepository.java

```java
package hello.core.member;

import java.util.HashMap;
import java.util.Map;

public class MemoryMemberRepository implements MemberRepository{

    private static Map<Long, Member> store = new HashMap<>();

    @Override
    public void save(Member member) {
        store.put(member.getId(), member);
    }

    @Override
    public Member findById(Long memberId) {
        return store.get(memberId);
    }
}
```

### ğŸ—¨ï¸ MemberService.java (Interface)

```java
package hello.core.member;

public interface MemberService {
    void join(Member member);
    Member findMember(Long memberId);
}
```

### ğŸ—¨ï¸ MemberServiceImpl.java

```java
package hello.core.member;

public class MemberServiceImpl implements MemberService{

    private final MemberRepository memberRepository = new MemoryMemberRepository();

    @Override
    public void join(Member member) {
        memberRepository.save(member);
    }

    @Override
    public Member findMember(Long memberId) {
        return memberRepository.findById(memberId);
    }
}
```

## 5. íšŒì› ë„ë©”ì¸ ì‹¤í–‰ê³¼ í…ŒìŠ¤íŠ¸

### ğŸ—¨ï¸ MemberApp.java

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

public class MemberApp {

    // psvm
    public static void main(String[] args) {
        MemberService memberService = new MemberServiceImpl();
        Member member = new Member(1L, "memberA", Grade.VIP);
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("new member : " + member.getName());
        System.out.println("findMember : " + findMember.getName());
    }
}
```

### ğŸ—¨ï¸ MemberServiceTest.java

```java
package hello.core.member;

import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

public class MemberServiceTest {

    MemberService memberService = new MemberServiceImpl();

    @Test
    void join(){
        //given
        Member member = new Member(1L, "memberA", Grade.VIP);

        //when
        memberService.join(member);
        Member findMember = memberService.findMember(1L);

        //then
        Assertions.assertThat(member).isEqualTo(findMember);
    }
}
```

- ì˜ì¡´ê´€ê³„ê°€ ì¸í„°í˜ì´ìŠ¤ ë¿ë§Œ ì•„ë‹ˆë¼ êµ¬í˜„ê¹Œì§€ ëª¨ë‘ ì˜ì¡´í•˜ëŠ” ë¬¸ì œì ì´ ìˆìŒ

```java
package hello.core.member;

public class MemberServiceImpl implements MemberService{
    // MemberServiceImplì€ MemberRepository(ì¶”ìƒí™”), MemoryMemberRepository(êµ¬ì²´í™”)ì— ì˜ì¡´í•¨ (DIP ìœ„ë°˜)
    private final MemberRepository memberRepository = new MemoryMemberRepository();

    @Override
    public void join(Member member) {
        memberRepository.save(member);
    }

    @Override
    public Member findMember(Long memberId) {
        return memberRepository.findById(memberId);
    }
}
```

## 6. ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ì„¤ê³„

### ì£¼ë¬¸ê³¼ í• ì¸ ì •ì±…

- íšŒì›ì€ ìƒí’ˆì„ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤.
- íšŒì› ë“±ê¸‰ì— ë”°ë¼ í• ì¸ ì •ì±…ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.
- í• ì¸ ì •ì±…ì€ ëª¨ë“  VIPëŠ” 1000ì›ì„ í• ì¸í•´ì£¼ëŠ” ê³ ì • ê¸ˆì•¡ í• ì¸ì„ ì ìš©í•´ë‹¬ë¼. (ë‚˜ì¤‘ì— ë³€ê²½ ê°€ëŠ¥)
- í• ì¸ ì •ì±…ì€ ë³€ê²½ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤. íšŒì‚¬ì˜ ê¸°ë³¸ í• ì¸ ì •ì±…ì„ ì•„ì§ ì •í•˜ì§€ ëª»í–ˆê³ , ì˜¤í”ˆ ì§ì „ê¹Œì§€ ê³ ë¯¼ì„ ë¯¸ë£¨ê³  ì‹¶ë‹¤. ìµœì•…ì˜ ê²½ìš° í• ì¸ì„ ì ìš©í•˜ì§€ ì•Šì„ ìˆ˜ ë„ ìˆë‹¤. (ë¯¸í™•ì •)

### ì—­í• 

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fd6a8085-ab45-4e83-85f7-45365ba331d7/Untitled.png)

1. **ì£¼ë¬¸ ìƒì„±** : í´ë¼ì´ì–¸íŠ¸ëŠ” ì£¼ë¬¸ ì„œë¹„ìŠ¤ì— ì£¼ë¬¸ ìƒì„±ì„ ìš”ì²­
2. **íšŒì› ì¡°íšŒ** : í• ì¸ì„ ìœ„í•´ì„œëŠ” íšŒì› ë“±ê¸‰ì´ í•„ìš”í•˜ë‹¤. ê·¸ë˜ì„œ ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” íšŒì› ì €ì¥ì†Œì—ì„œ íšŒì›ì„ ì¡°íšŒ
3. **í• ì¸ ì ìš©** : ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” íšŒì› ë“±ê¸‰ì— ë”°ë¥¸ í• ì¸ ì—¬ë¶€ë¥¼ í• ì¸ ì •ì±…ì— ìœ„ì„
4. **ì£¼ë¬¸ ê²°ê³¼ ë°˜í™˜**: ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” í• ì¸ ê²°ê³¼ë¥¼ í¬í•¨í•œ ì£¼ë¬¸ ê²°ê³¼ë¥¼ ë°˜í™˜

### ì—­í• ê³¼ êµ¬í˜„(ì „ì²´)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/21e26b71-d863-4567-84ad-1e76f8dce985/Untitled.png)

â‡’ ì—­í• ê³¼ êµ¬í˜„ì„ ë¶„ë¦¬í•´ì„œ ììœ ë¡­ê²Œ êµ¬í˜„ ê°ì²´ë¥¼ ì¡°ë¦½í•  ìˆ˜ ìˆê²Œ ì„¤ê³„í–ˆë‹¤. ë•ë¶„ì— íšŒì› ì €ì¥ì†ŒëŠ” ë¬¼ë¡ ì´ê³ , í• ì¸ ì •ì±…ë„ ìœ ì—°í•˜ê²Œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/36e65359-8253-497a-861c-08478926b660/Untitled.png)

- ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•œ êµ¬í˜„ì²´ê°€ ë‹¨ í•˜ë‚˜ë§Œ ìˆì„ê²½ìš°, Implì„ ë¶™ì´ëŠ” ê´€ë¡€ê°€ ìˆìŒ

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/64fa02f1-0df6-459f-bb67-d982309a9d7f/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/97c67fd5-1d08-461d-bbac-e405566eb0d8/Untitled.png)

â‡’ ì£¼ë¬¸ ì„œë¹„ìŠ¤ë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ , ì—­í• ë“¤ì˜ í˜‘ë ¥ ê´€ê³„ë¥¼ ê·¸ëŒ€ë¡œ ì¬ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.

## 7. ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ê°œë°œ

### ğŸ—¨ï¸ DiscountPolicy.java (Interface)

```java
package hello.core.discount;

import hello.core.member.Member;

public interface DiscountPolicy {
    /** @return í• ì¸ ëŒ€ìƒ ê¸ˆì•¡ */
    int discount(Member member, int price);
}
```

### ğŸ—¨ï¸ FixDiscountPollicy.java

```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;

public class FixDiscountPollicy implements DiscountPolicy{

    private int discountFixAmount = 1000; // 1000ì› í• ì¸

    @Override
    public int discount(Member member, int price) {
        if(member.getGrade() == Grade.VIP){
            return discountFixAmount;
        }else{
            return 0;
        }
    }
}
```

### ğŸ—¨ï¸ Order.java

```java
package hello.core.order;

public class Order {

    private Long memberId;
    private String itemName;
    private int itemPrice;
    private int discountPrice;

    public Order(Long memberId, String itemName, int itemPrice, int discountPrice) {
        this.memberId = memberId;
        this.itemName = itemName;
        this.itemPrice = itemPrice;
        this.discountPrice = discountPrice;
    }

    public int calculatePrice(){
        return itemPrice - discountPrice;
    }

    public Long getMemberId() {
        return memberId;
    }

    public void setMemberId(Long memberId) {
        this.memberId = memberId;
    }

    public String getItemName() {
        return itemName;
    }

    public void setItemName(String itemName) {
        this.itemName = itemName;
    }

    public int getItemPrice() {
        return itemPrice;
    }

    public void setItemPrice(int itemPrice) {
        this.itemPrice = itemPrice;
    }

    public int getDiscountPrice() {
        return discountPrice;
    }

    public void setDiscountPrice(int discountPrice) {
        this.discountPrice = discountPrice;
    }

    @Override
    public String toString() {
        return "Order{" +
                "memberId=" + memberId +
                ", itemName='" + itemName + '\'' +
                ", itemPrice=" + itemPrice +
                ", discountPrice=" + discountPrice +
                '}';
    }
}
```

### ğŸ—¨ï¸ OrderService.java (Interface)

```java
package hello.core.order;

public interface OrderService {
    Order createOrder(Long memberId, String itemName, int itemPrice);
}
```

### ğŸ—¨ï¸ OrderServiceImpl.java

```java
package hello.core.order;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPollicy;
import hello.core.member.Member;
import hello.core.member.MemberRepository;
import hello.core.member.MemoryMemberRepository;

public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy = new FixDiscountPollicy();

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);

        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

## 8. ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ì‹¤í–‰ê³¼ í…ŒìŠ¤íŠ¸

### ğŸ—¨ï¸ OrderApp.java

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.order.Order;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

public class OrderApp {

    public static void main(String[] args) {
        MemberService memberService = new MemberServiceImpl();
        OrderService orderService = new OrderServiceImpl();

        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);
        System.out.println("order = " + order);
    }
}
```

### ğŸ—¨ï¸ OrderServiceTest.java

```java
package hello.core.order;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

public class OrderServiceTest {
    MemberService memberService = new MemberServiceImpl();
    OrderService orderService = new OrderServiceImpl();

    @Test
    void createOrder() {
        long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);
        Assertions.assertThat(order.getDiscountPrice()).isEqualTo(1000);
    }

}
```
