# [3] ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ ì´í•´2 - ê°ì²´ ì§€í–¥ ì›ë¦¬ ì ìš©

## 1. ìƒˆë¡œìš´ í• ì¸ ì •ì±… ê°œë°œ

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9f0f47e7-e69c-405b-89e6-09d4fe041513/Untitled.png)

### ğŸ—¨ï¸ RateDiscountPolicy.java

```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;

public class RateDiscountPolicy implements DiscountPolicy {
    private int discountPrice = 10;

    @Override
    public int discount(Member member, int price) { // Ctrl + shift + T : í…ŒìŠ¤íŠ¸ì½”ë“œ ë°”ë¡œ ìƒì„±
        if(member.getGrade() == Grade.VIP){
            return price * discountPrice / 100;
        }else {
            return 0;
        }
    }
}
```

### ğŸ—¨ï¸ RateDiscountPolicyTest.java

```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

// Assertionsì— alt+ì—”í„° => static ì ìš©
import static org.assertj.core.api.Assertions.*;

class RateDiscountPolicyTest {

    RateDiscountPolicy discountPolicy = new RateDiscountPolicy();

    @Test
    @DisplayName("VIPëŠ” 10% í• ì¸ì´ ì ìš©ë˜ì–´ì•¼ í•œë‹¤")
    void vip_o(){
        //given
        Member member = new Member(1L, "memberVIP", Grade.VIP);
        //when
        int discount = discountPolicy.discount(member, 10000);
        //then
        assertThat(discount).isEqualTo(1000);
    }

    @Test
    @DisplayName("VIPê°€ ì•„ë‹ˆë©´ í• ì¸ì´ ì ìš©ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤")
    void vip_x(){
        //given
        Member member = new Member(1L, "memberBASIC", Grade.BASIC);
        //when
        int discount = discountPolicy.discount(member, 10000);
        //then
        assertThat(discount).isEqualTo(0);
    }

}
```

## 2. ìƒˆë¡œìš´ í• ì¸ ì •ì±… ì ìš©ê³¼ ë¬¸ì œì 

### ğŸ—¨ï¸ OrderServiceImpl.java

```java
package hello.core.order;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPollicy;
import hello.core.discount.RateDiscountPolicy;
import hello.core.member.Member;
import hello.core.member.MemberRepository;
import hello.core.member.MemoryMemberRepository;

public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository = new MemoryMemberRepository();

    // private final DiscountPolicy discountPolicy = new FixDiscountPollicy();
    // í• ì¸ ì •ì±…ì„ ë³€ê²½í•˜ë ¤ë©´, í´ë¼ì´ì–¸íŠ¸ì¸ OrderServiceImpl ì½”ë“œë¥¼ ê³ ì³ì•¼í•œë‹¤
    // private final DiscountPolicy discountPolicy = new RateDiscountPolicy();

    private DiscountPolicy discountPolicy; // ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ë°”ê¾¼ ì½”ë“œ but) NPE ë°œìƒ
    // ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´, ëˆ„êµ°ê°€ê°€ í´ë¼ì´ì–¸íŠ¸ì¸ OrderServiceImplì— DiscountPolicyì˜ êµ¬í˜„ ê°ì²´ë¥¼ ëŒ€ì‹ í•˜ê³  ì£¼ì…í•´ì£¼ì–´ì•¼ í•¨

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);

        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

### ê³ ì°°

- ìš°ë¦¬ëŠ” **ì—­í• ê³¼ êµ¬í˜„ì„ ì¶©ì‹¤í•˜ê²Œ ë¶„ë¦¬**í–ˆë‹¤. OK
- **ë‹¤í˜•ì„±ë„ í™œìš©**í•˜ê³ , **ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ ê°ì²´ë¥¼ ë¶„ë¦¬**í–ˆë‹¤. OK
- **OCP, DIP ê°™ì€ ê°ì²´ì§€í–¥ ì„¤ê³„ ì›ì¹™ì„ ì¶©ì‹¤íˆ ì¤€ìˆ˜**í–ˆë‹¤
  - ê·¸ë ‡ê²Œ ë³´ì´ì§€ë§Œ **ì‚¬ì‹¤ì€ ì•„ë‹ˆë‹¤.**
- **DIP** : ì£¼ë¬¸ì„œë¹„ìŠ¤ í´ë¼ì´ì–¸íŠ¸( OrderServiceImpl )ëŠ” DiscountPolicy ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•˜ë©´ì„œ DIPë¥¼
  ì§€í‚¨ ê²ƒ ê°™ì€ë°? - **í´ë˜ìŠ¤ ì˜ì¡´ê´€ê³„ë¥¼ ë¶„ì„** - **ì¶”ìƒ(ì¸í„°í˜ì´ìŠ¤) ì˜ì¡´**: DiscountPolicy - **êµ¬ì²´(êµ¬í˜„) í´ë˜ìŠ¤**: FixDiscountPolicy , RateDiscountPolicy
- **OCP**: ë³€ê²½í•˜ì§€ ì•Šê³  í™•ì¥í•  ìˆ˜ ìˆë‚˜?
  - ì§€ê¸ˆ ì½”ë“œëŠ” ê¸°ëŠ¥ì„ í™•ì¥í•´ì„œ ë³€ê²½í•˜ë©´, **í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì— ì˜í–¥**ì„ ì¤€ë‹¤! OCP ìœ„ë°˜!

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7563eada-910b-421a-8a0e-b8817baec9fc/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/700d6bc5-0077-4fff-a9bc-4ebb057a7c9d/Untitled.png)

```java
public class OrderServiceImpl implements OrderService{
    private final MemberRepository memberRepository = new MemoryMemberRepository();

    // í• ì¸ ì •ì±…ì„ ë³€ê²½í•˜ë ¤ë©´, í´ë¼ì´ì–¸íŠ¸ì¸ OrderServiceImpl ì½”ë“œë¥¼ ê³ ì³ì•¼í•œë‹¤
    // private final DiscountPolicy discountPolicy = new FixDiscountPollicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
}
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ddb9ea06-08fe-45e7-bea6-b6cf31f74425/Untitled.png)

- FixDiscountPolicyë¥¼ RateDiscountPolicyë¡œ ë³€ê²½í•˜ëŠ” ìˆœê°„ OrderServiceImplì˜ ì†ŒìŠ¤ ì½”ë“œë„ í•¨ê»˜ ë³€ê²½í•´ì•¼ í•¨! OCP ìœ„ë°˜

### í•´ê²°ë°©ë²•

- ì¶”ìƒì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ë³€ê²½í•´ì•¼í•˜ë¯€ë¡œ, ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ê²Œ í•œë‹¤.

```java
public class OrderServiceImpl implements OrderService {
 //private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
 private DiscountPolicy discountPolicy;
}
```

but) NPE(NullpointerException) ë°œìƒ : êµ¬í˜„ì²´ê°€ ì—†ìŒ

So, ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´ ëˆ„êµ°ê°€ê°€ í´ë¼ì´ì–¸íŠ¸ì¸ OrderServiceImplì— **DiscountPolicyì˜ êµ¬í˜„ ê°ì²´ë¥¼ ëŒ€ì‹  ìƒì„±í•˜ê³  ì£¼ì…**í•´ì£¼ì–´ì•¼ í•œë‹¤.

## 3. ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

### ì½”ë“œ ë¶„ì„

```java
DiscountPolicy discountPolicy = new RateDiscountPolicy();
```

ë¹„ìœ í•˜ë©´, DiscountPolicyë¼ëŠ” ë°°ìš°ê°€ ë‹¤ë¥¸ ë°°ìš°(RateDiscountPolicy)ë¥¼ ì§ì ‘ ì´ˆë¹™í•´ì˜¤ëŠ” ê²ƒê³¼ ê°™ìŒ

but) ë°°ìš°ëŠ” ë³¸ì¸ì˜ ë°°ì—­ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì—ë§Œ ì§‘ì¤‘í•´ì•¼ í•¨. ì¦‰, ì´ˆë¹™í•´ì˜¤ëŠ” ìª½ì€ ë³„ë„ì˜ ê³µì—° ê¸°íšìê°€ í•´ì•¼í•¨!

### ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬

### ğŸ—¨ï¸ AppConfig.java

```java
package hello.core;

import hello.core.discount.FixDiscountPollicy;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

// ê´€ì‹¬ì‚¬ ë¶„ë¦¬
public class AppConfig {

    public MemberService memberService(){
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService(){
        return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPollicy());
    }
}
```

- ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤ì œ ë™ì‘ì— í•„ìš”í•œ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±
  - `MemberServiceImpl`, `MemoryMemberRepository`, `OrderServiceImpl`, `FixDiscountPolicy`
- ìƒì„±í•œ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡°(ë ˆí¼ëŸ°ìŠ¤)ë¥¼ ìƒì„±ìë¥¼ í†µí•´ì„œ ì£¼ì…(ì—°ê²°)í•´ì¤Œ
  - `MemberServiceImpl` â‡’ `MemoryMemberRepository`
  - `OrderServiceImpl` â‡’ `MemoryMemberRepository`, `FixDiscountPolicy`

### ğŸ—¨ï¸ MemberServiceImpl.java

```java
package hello.core.member;

public class MemberServiceImpl implements MemberService{

    // MemberServiceImplì€ MemberRepository(ì¶”ìƒí™”), MemoryMemberRepository(êµ¬ì²´í™”)ì— ì˜ì¡´í•¨ (DIP ìœ„ë°˜)
    // private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final MemberRepository memberRepository;

    public MemberServiceImpl(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    @Override
    public void join(Member member) {
        memberRepository.save(member);
    }

    @Override
    public Member findMember(Long memberId) {
        return memberRepository.findById(memberId);
    }
}
```

- `MemberRepository` ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´
- `MemberServiceImpl` ì…ì¥ì—ì„œ ìƒì„±ìë¥¼ í†µí•´ ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ë“¤ì–´ì˜¬ì§€ëŠ” ì•Œ ìˆ˜ ì—†ê³ , AppConfigì—ì„œ ê²°ì •ë¨

â‡’ ì˜ì¡´ê´€ê³„ì— ëŒ€í•œ ê³ ë¯¼ì€ ì™¸ë¶€ì— ë§¡ê¸°ê³  **ì‹¤í–‰ì—ë§Œ ì§‘ì¤‘**

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5afd3f0d-a968-403d-91d6-4e9dc0111a87/Untitled.png)

- **DIP ì™„ì„±** : MemberServiceImpl ì€ MemberRepository ì¸ ì¶”ìƒì—ë§Œ ì˜ì¡´, ì´ì œ êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ëª°ë¼ë„ ë¨!
- **ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬** : ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì—°ê²°í•˜ëŠ” ì—­í• ê³¼ ì‹¤í–‰í•˜ëŠ” ì—­í• ì´ ëª…í™•íˆ ë¶„ë¦¬ë˜ì—ˆë‹¤.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ffdfffd7-1f5c-46da-8b04-e8ad5751860c/Untitled.png)

- `appConfig`ê°ì²´ëŠ” `memoryMemberRepository` ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ê·¸ ì°¸ì¡°ê°’ì„ `memberServiceImpl`ì„ ìƒì„±í•˜ë©´ì„œ ìƒì„±ìë¡œ ì „ë‹¬
- í´ë¼ì´ì–¸íŠ¸ì¸ `memberServiceImpl` ì…ì¥ì—ì„œ ë³´ë©´ ì˜ì¡´ê´€ê³„ë¥¼ ë§ˆì¹˜ ì™¸ë¶€ì—ì„œ ì£¼ì…í•´ì£¼ëŠ” ê²ƒ ê°™ë‹¤ê³  í•´ì„œ
  DI(Dependency Injection) ìš°ë¦¬ë§ë¡œ ì˜ì¡´ê´€ê³„ ì£¼ì… ë˜ëŠ” ì˜ì¡´ì„± ì£¼ì…ì´ë¼ í•¨

### ğŸ—¨ï¸ OrderServiceImpl.java

```java
package hello.core.order;

import hello.core.discount.DiscountPolicy;
import hello.core.member.Member;
import hello.core.member.MemberRepository;

public class OrderServiceImpl implements OrderService{

    // private final MemberRepository memberRepository = new MemoryMemberRepository();
    // private final DiscountPolicy discountPolicy = new FixDiscountPollicy();
    // í• ì¸ ì •ì±…ì„ ë³€ê²½í•˜ë ¤ë©´, í´ë¼ì´ì–¸íŠ¸ì¸ OrderServiceImpl ì½”ë“œë¥¼ ê³ ì³ì•¼í•œë‹¤
    // private final DiscountPolicy discountPolicy = new RateDiscountPolicy();

    // private final DiscountPolicy discountPolicy; // ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ë°”ê¾¼ ì½”ë“œ but) NPE ë°œìƒ
    // ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´, ëˆ„êµ°ê°€ê°€ í´ë¼ì´ì–¸íŠ¸ì¸ OrderServiceImplì— DiscountPolicyì˜ êµ¬í˜„ ê°ì²´ë¥¼ ëŒ€ì‹ í•˜ê³  ì£¼ì…í•´ì£¼ì–´ì•¼ í•¨

    // ê´€ì‹¬ì‚¬ ë¶„ë¦¬ - AppConfigì—ì„œ ì£¼ì…
    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);

        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

- OrderServiceImpl ì—ëŠ” MemoryMemberRepository , FixDiscountPolicy ê°ì²´ì˜ ì˜ì¡´ê´€ê³„ê°€ ì£¼ì…ëœë‹¤.

### ğŸ—¨ï¸ MemberApp.java

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

public class MemberApp {

    // psvm
    public static void main(String[] args) {
        AppConfig appConfig = new AppConfig();
        MemberService memberService = appConfig.memberService();
        Member member = new Member(1L, "memberA", Grade.VIP);
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("new member : " + member.getName());
        System.out.println("findMember : " + findMember.getName());
    }
}
```

### ğŸ—¨ï¸ OrderApp.java

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.order.Order;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

public class OrderApp {

    public static void main(String[] args) {

        // MemberService memberService = new MemberServiceImpl(memberRepository);
        // OrderService orderService = new OrderServiceImpl(memberRepository, discountPolicy);

        AppConfig appConfig = new AppConfig();
        MemberService memberService = appConfig.memberService();
        OrderService orderService = appConfig.orderService();

        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);
        System.out.println("order = " + order);
    }
}
```

### ğŸ—¨ï¸ MemberApp.java

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

public class MemberApp {

    // psvm
    public static void main(String[] args) {
        AppConfig appConfig = new AppConfig();
        MemberService memberService = appConfig.memberService();
        Member member = new Member(1L, "memberA", Grade.VIP);
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("new member : " + member.getName());
        System.out.println("findMember : " + findMember.getName());
    }
}
```

### ğŸ—¨ï¸ [MemberServiceTest.java](http://MemberServiceTest.java) (ìˆ˜ì •)

```java
package hello.core.member;

import hello.core.AppConfig;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

public class MemberServiceTest {

    // MemberService memberService = new MemberServiceImpl(memberRepository);

    MemberService memberService;

    @BeforeEach
    public void beforeEach(){
        AppConfig appConfig = new AppConfig();
        memberService = appConfig.memberService();
    }

    @Test
    void join(){
        //given
        Member member = new Member(1L, "memberA", Grade.VIP);

        //when
        memberService.join(member);
        Member findMember = memberService.findMember(1L);

        //then
        Assertions.assertThat(member).isEqualTo(findMember);
    }
}
```

### ğŸ—¨ï¸ OrderServiceTest.java (ìˆ˜ì •)

```java
package hello.core.order;

import hello.core.AppConfig;
import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

public class OrderServiceTest {
    // MemberService memberService = new MemberServiceImpl(memberRepository);
    // OrderService orderService = new OrderServiceImpl(memberRepository, discountPolicy);

    MemberService memberService;
    OrderService orderService;

    @BeforeEach
    public void beforeEach(){
        AppConfig appConfig = new AppConfig();
        memberService = appConfig.memberService();
        orderService = appConfig.orderService();
    }

    @Test
    void createOrder() {
        long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);
        Assertions.assertThat(order.getDiscountPrice()).isEqualTo(1000);
    }

}
```

### ì •ë¦¬

- AppConfigë¥¼ í†µí•´ì„œ ê´€ì‹¬ì‚¬ë¥¼ í™•ì‹¤í•˜ê²Œ ë¶„ë¦¬!
- AppConfigëŠ” ê³µì—° ê¸°íšìë¡œ, ë°°ì—­ì— ë§ëŠ” ë‹´ë‹¹ ë°°ìš°(êµ¬ì²´ í´ë˜ìŠ¤)ë¥¼ ì„ íƒí•œë‹¤.
  ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì–´ë–»ê²Œ ë™ì‘í•´ì•¼ í• ì§€ **ì „ì²´ êµ¬ì„±ì„ ì±…ì„**ì§„ë‹¤.
- ì´ì œ ê° ë°°ìš°ë“¤( `OrderServiceImpl` )ì€ ë‹´ë‹¹ ê¸°ëŠ¥ì„ ì‹¤í–‰í•˜ëŠ” ì±…ì„ë§Œ ì§€ë©´ ëœë‹¤.

## 4. AppConfig ë¦¬íŒ©í„°ë§

- í˜„ì¬ AppConfigë¥¼ ë³´ë©´ ì¤‘ë³µì´ ìˆê³ , ì—­í• ì— ë”°ë¥¸ êµ¬í˜„ì´ ì˜ ë³´ì´ì§€ ì•ŠìŒ

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/72a04556-269c-4cd0-885a-c45ec4765cf3/Untitled.png)

### ğŸ—¨ï¸ AppConfig.java

```java
package hello.core;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPollicy;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

/** AppConfig(ê¸°íšì)ë¥¼ í†µí•´ ê´€ì‹¬ì‚¬ ë¶„ë¦¬ */
public class AppConfig {

//    // ì•„ë˜ ë°©ì‹ëŒ€ë¡œ í•˜ë©´, ì„¤ì • ì •ë³´ë¥¼ ë‹´ëŠ” ê³³ì´ë¯€ë¡œ ì—­í• ì— ë”°ë¥¸ êµ¬í˜„ì´ í•œëˆˆì— ë³´ì—¬ì•¼ í•˜ëŠ”ë° ê·¸ë ‡ì§€ ëª»í•¨
//    public MemberService memberService(){
//        return new MemberServiceImpl(new MemoryMemberRepository());
//    }
//
//    public OrderService orderService(){
//        return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPollicy());
//    }

    /** ë¦¬íŒ©í† ë§ (Ctrl + Alt + M) */
    // ê²°ê³¼
    // 1. new MemoryMemberRepository() ì´ ë¶€ë¶„ì´ ì¤‘ë³µ ì œê±° (ë‹¤ë¥¸ êµ¬í˜„ì²´ë¡œ ë³€ê²½í•  ë•Œ í•œ ë¶€ë¶„ë§Œ ë³€ê²½í•˜ë©´ ë¨)
    // 2. AppConfig ë¥¼ ë³´ë©´ ì—­í• ê³¼ êµ¬í˜„ í´ë˜ìŠ¤ê°€ í•œëˆˆì— ë“¤ì–´ì˜´ (ì „ì²´ êµ¬ì„± ë¹ ë¥´ê²Œ íŒŒì•… ê°€ëŠ¥)
    public MemberService memberService(){
        return new MemberServiceImpl(memberRepository());
    }

    private MemoryMemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

    public OrderService orderService(){
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    public DiscountPolicy discountPolicy(){
        return new FixDiscountPollicy();
    }
}
```

## 5. ìƒˆë¡œìš´ êµ¬ì¡°ì™€ í• ì¸ ì •ì±… ì ìš©

- ì •ì•¡ í• ì¸ ì •ì±…ì„ ì •ë¥ % í• ì¸ ì •ì±…ìœ¼ë¡œ ë³€ê²½

### ğŸ—¨ï¸ AppConfig.java (í•œì¤„ ë³€ê²½)

```java
package hello.core;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPollicy;
import hello.core.discount.RateDiscountPolicy;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

/** AppConfig(ê¸°íšì)ë¥¼ í†µí•´ ê´€ì‹¬ì‚¬ ë¶„ë¦¬ */
public class AppConfig {

//    // ì•„ë˜ ë°©ì‹ëŒ€ë¡œ í•˜ë©´, ì„¤ì • ì •ë³´ë¥¼ ë‹´ëŠ” ê³³ì´ë¯€ë¡œ ì—­í• ì— ë”°ë¥¸ êµ¬í˜„ì´ í•œëˆˆì— ë³´ì—¬ì•¼ í•˜ëŠ”ë° ê·¸ë ‡ì§€ ëª»í•¨
//    public MemberService memberService(){
//        return new MemberServiceImpl(new MemoryMemberRepository());
//    }
//
//    public OrderService orderService(){
//        return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPollicy());
//    }

    /** ë¦¬íŒ©í† ë§ (Ctrl + Alt + M) */
    // ê²°ê³¼
    // 1. new MemoryMemberRepository() ì´ ë¶€ë¶„ì´ ì¤‘ë³µ ì œê±° (ë‹¤ë¥¸ êµ¬í˜„ì²´ë¡œ ë³€ê²½í•  ë•Œ í•œ ë¶€ë¶„ë§Œ ë³€ê²½í•˜ë©´ ë¨)
    // 2. AppConfig ë¥¼ ë³´ë©´ ì—­í• ê³¼ êµ¬í˜„ í´ë˜ìŠ¤ê°€ í•œëˆˆì— ë“¤ì–´ì˜´ (ì „ì²´ êµ¬ì„± ë¹ ë¥´ê²Œ íŒŒì•… ê°€ëŠ¥)
    public MemberService memberService(){
        return new MemberServiceImpl(memberRepository());
    }

    private MemoryMemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

    public OrderService orderService(){
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    public DiscountPolicy discountPolicy(){
//        return new FixDiscountPollicy();
        return new RateDiscountPolicy();
    }
}
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/192118a5-f30e-4ede-a20f-9624e84b925c/Untitled.png)

â‡’ `AppConfig`ì˜ ë“±ì¥ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í¬ê²Œ ì‚¬ìš© ì˜ì—­ê³¼, ê°ì²´ë¥¼ ìƒì„±í•˜ê³  êµ¬ì„±(Configuration)í•˜ëŠ” ì˜ì—­ìœ¼ë¡œ ë¶„ë¦¬ë˜ì—ˆê¸° ë•Œë¬¸ì—, `FixDiscountPolicy`, `RateDiscountPolicy`ë¡œ ë³€ê²½í•´ë„ êµ¬ì„± ì˜ì—­ë§Œ ì˜í–¥ì„ ë°›ê³ , ì‚¬ìš© ì˜ì—­ì€ ì „í˜€ ì˜í–¥ì„ ë°›ì§€ ì•ŠìŒ!

## 6. ì „ì²´ íë¦„ ì •ë¦¬

### ìƒˆë¡œìš´ í• ì¸ ì •ì±… ê°œë°œ

- ë‹¤í˜•ì„± ë•ë¶„ì— ìƒˆë¡œìš´ ì •ë¥  í• ì¸ ì •ì±… ì½”ë“œë¥¼ ì¶”ê°€ë¡œ ê°œë°œí•˜ëŠ” ê²ƒ ìì²´ëŠ” ë¬¸ì œê°€ ì—†ìŒ

### ìƒˆë¡œìš´ í• ì¸ ì •ì±… ì ìš©ê³¼ ë¬¸ì œì 

- ìƒˆë¡œ ê°œë°œí•œ ì •ë¥  í• ì¸ ì •ì±…ì„ ì ìš©í•˜ë ¤ê³  í•˜ë‹ˆ **â€œí´ë¼ì´ì–¸íŠ¸ ì½”ë“œâ€**ì¸ ì£¼ë¬¸ ì„œë¹„ìŠ¤ êµ¬í˜„ì²´ë„ í•¨ê»˜ ë³€ê²½í•´ì•¼í•¨
- ì£¼ë¬¸ ì„œë¹„ìŠ¤ í´ë¼ì´ì–¸íŠ¸ê°€ ì¸í„°í˜ì´ìŠ¤ì¸ `DiscountPolicy` ë¿ë§Œ ì•„ë‹ˆë¼, êµ¬ì²´ í´ë˜ìŠ¤ì¸
  `FixDiscountPolicy` ë„ í•¨ê»˜ ì˜ì¡´ â†’ **DIP ìœ„ë°˜**

### ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

- ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í•˜ë‚˜ì˜ ê³µì—°ìœ¼ë¡œ ìƒê°í•´ë³´ë©´, ê¸°ì¡´ì—ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì˜ì¡´í•˜ëŠ” ì„œë²„ êµ¬í˜„ ê°ì²´ë¥¼ ì§ì ‘ ìƒì„±í•˜ê³ , ì‹¤í–‰í•˜ëŠ” í˜•íƒœì˜€ìŒ
- ë‚¨ì ì£¼ì¸ê³µ ë°°ìš°ê°€ ê³µì—°ë„ í•˜ê³ , ë™ì‹œì— ì—¬ì ì£¼ì¸ê³µë„ ì§ì ‘ ì´ˆë¹™í•˜ëŠ” ë‹¤ì–‘í•œ ì±…ì„ì„ ê°€ì¡Œë˜ ê²ƒ
- ê³µì—°ì„ êµ¬ì„±í•˜ê³ , ë‹´ë‹¹ ë°°ìš°ë¥¼ ì„­ì™¸í•˜ê³ , ì§€ì •í•˜ëŠ” ì±…ì„ì„ ë‹´ë‹¹í•˜ëŠ” ë³„ë„ì˜ **ê³µì—° ê¸°íšì**ê°€ í•„ìš”í•¨ â†’ `AppConfig`ê°€ ë“±ì¥
- `AppConfig`ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì „ì²´ ë™ì‘ ë°©ì‹ì„ êµ¬ì„±(config)í•˜ê¸° ìœ„í•´, **êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±**í•˜ê³ , **ì—°ê²°**í•˜ëŠ” ì±…ì„ì„ ê°€ì§
- ì´ì œë¶€í„° í´ë¼ì´ì–¸íŠ¸ ê°ì²´ëŠ” ìì‹ ì˜ ì—­í• ì„ ì‹¤í–‰í•˜ëŠ” ê²ƒë§Œ ì§‘ì¤‘í•¨
  â†’ ê¶Œí•œì´ ì¤„ì–´ë“¬(ì±…ì„ì´ ëª…í™•í•´ì§)

### AppConfig ë¦¬íŒ©í„°ë§

- êµ¬ì„± ì •ë³´ì—ì„œ ì—­í• ê³¼ êµ¬í˜„ì„ ëª…í™•í•˜ê²Œ ë¶„ë¦¬
- ì—­í• ì´ ì˜ ë“œëŸ¬ë‚¨
- ì¤‘ë³µ ì œê±°

### ìƒˆë¡œìš´ êµ¬ì¡°ì™€ í• ì¸ ì •ì±… ì ìš©

- ì •ì•¡ í• ì¸ ì •ì±… â†’ ì •ë¥ % í• ì¸ ì •ì±…ìœ¼ë¡œ ë³€ê²½
- `AppConfig`ì˜ ë“±ì¥ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í¬ê²Œ **ì‚¬ìš© ì˜ì—­**ê³¼, ê°ì²´ë¥¼ ìƒì„±í•˜ê³  **êµ¬ì„±(Configuration)í•˜ëŠ” ì˜ì—­**ìœ¼ë¡œ ë¶„ë¦¬
- í• ì¸ ì •ì±…ì„ ë³€ê²½í•´ë„ `AppConfig`ê°€ ìˆëŠ” êµ¬ì„± ì˜ì—­ë§Œ ë³€ê²½í•˜ë©´ ë¨
- ì‚¬ìš© ì˜ì—­ ë³€ê²½ X, í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì¸ ì£¼ë¬¸ ì„œë¹„ìŠ¤ ì½”ë“œ ë³€ê²½ X

## 7. ì¢‹ì€ ê°ì²´ ì§€í–¥ ì„¤ê³„ì˜ 5ê°€ì§€ ì›ì¹™ ì ìš©

- ì—¬ê¸°ì„œ 3ê°€ì§€ SRP, DIP, OCP ì ìš©

### SRP ë‹¨ì¼ ì±…ì„ ì›ì¹™

- â€œ**í•œ í´ë˜ìŠ¤ëŠ” í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì ¸ì•¼ í•œë‹¤.â€**
- í´ë¼ì´ì–¸íŠ¸ ê°ì²´ëŠ” ì§ì ‘ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì—°ê²°í•˜ê³ , ì‹¤í–‰í•˜ëŠ” ë‹¤ì–‘í•œ ì±…ì„ì„ ê°€ì§€ê³  ìˆì—ˆê¸° ë•Œë¬¸ì—, SRP ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ë”°ë¥´ë©´ì„œ ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•˜ë„ë¡ ì„¤ê³„í•´ì•¼ í–ˆìŒ
- **`AppConfig`** : êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì—°ê²°í•˜ëŠ” ì±…ì„ ë‹´ë‹¹
- **í´ë¼ì´ì–¸íŠ¸ ê°ì²´** : ì‹¤í–‰í•˜ëŠ” ì±…ì„ë§Œ ë‹´ë‹¹

### DIP ì˜ì¡´ê´€ê³„ ì—­ì „ ì›ì¹™

- â€œ**í”„ë¡œê·¸ë˜ë¨¸ëŠ” ì¶”ìƒí™”ì— ì˜ì¡´í•´ì•¼ì§€, êµ¬ì²´í™”ì— ì˜ì¡´í•˜ë©´ ì•ˆëœë‹¤.â€**
- ì˜ì¡´ì„± ì£¼ì…ì€ ì´ ì›ì¹™ì„ ë”°ë¥´ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜
- ìƒˆë¡œìš´ í• ì¸ ì •ì±…ì„ ê°œë°œí•˜ê³ , ì ìš©í•˜ë ¤ê³  í•˜ë‹ˆ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë„ í•¨ê»˜ ë³€ê²½í•´ì•¼ í–ˆìŒ ì™œëƒí•˜ë©´ ê¸°ì¡´ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ( `OrderServiceImpl` )ëŠ” DIPë¥¼ ì§€í‚¤ë©° `DiscountPolicy` ì¶”ìƒí™” ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•˜ëŠ” ê²ƒ ê°™ì•˜ì§€ë§Œ, ì‚¬ì‹¤ì€ `FixDiscountPolicy` êµ¬ì²´í™” êµ¬í˜„ í´ë˜ìŠ¤ì—ë„ í•¨ê»˜ ì˜ì¡´í–ˆë‹¤.
- í´ë¼ì´ì–¸íŠ¸ ì½”ë“œê°€ `DiscountPolicy` ì¶”ìƒí™” ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ì½”ë“œë¥¼ ë³€ê²½
  but) í´ë¼ì´ì–¸íŠ¸ ì½”ë“œëŠ” ì¸í„°í˜ì´ìŠ¤ë§Œìœ¼ë¡œëŠ” ì•„ë¬´ê²ƒë„ ì‹¤í–‰í•  ìˆ˜ ì—†ë‹¤.
- `AppConfig`ê°€ `FixDiscountPolicy` ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ëŒ€ì‹  ìƒì„±í•´ì„œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì— ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í–ˆë‹¤. ì´ë ‡ê²Œí•´ì„œ DIP ì›ì¹™ì„ ë”°ë¥´ë©´ì„œ ë¬¸ì œë„ í•´ê²°í–ˆë‹¤.

### OCP

- â€œ**ì†Œí”„íŠ¸ì›¨ì–´ ìš”ì†ŒëŠ” í™•ì¥ì—ëŠ” ì—´ë ¤ ìˆìœ¼ë‚˜ ë³€ê²½ì—ëŠ” ë‹«í˜€ ìˆì–´ì•¼ í•œë‹¤.â€**
- ë‹¤í˜•ì„± ì‚¬ìš©í•˜ê³  í´ë¼ì´ì–¸íŠ¸ê°€ DIPë¥¼ ì§€í‚´
- ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‚¬ìš© ì˜ì—­ê³¼ êµ¬ì„± ì˜ì—­ìœ¼ë¡œ ë‚˜ëˆ”
- `AppConfig`ê°€ ì˜ì¡´ê´€ê³„ë¥¼ `FixDiscountPolicy` â†’ `RateDiscountPolicy` ë¡œ ë³€ê²½í•´ì„œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì— ì£¼ì…í•˜ë¯€ë¡œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œëŠ” ë³€ê²½í•˜ì§€ ì•Šì•„ë„ ë¨
- ì†Œí”„íŠ¸ì›¨ì–´ ìš”ì†Œë¥¼ ìƒˆë¡­ê²Œ í™•ì¥í•´ë„ ì‚¬ìš© ì˜ì—­ì˜ ë³€ê²½ì€ ë‹«í˜€ ìˆë‹¤!

## 8. IoC, DI, ê·¸ë¦¬ê³  ì»¨í…Œì´ë„ˆ

### < ì œì–´ì˜ ì—­ì „ IoC(Inversion of Control) >

- ê¸°ì¡´ í”„ë¡œê·¸ë¨ì€ í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„ ê°ì²´ê°€ ìŠ¤ìŠ¤ë¡œ í•„ìš”í•œ ì„œë²„ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì—°ê²°í•˜ê³ , ì‹¤í–‰í–ˆë‹¤. í•œë§ˆë””ë¡œ êµ¬í˜„ ê°ì²´ê°€ í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì„ ìŠ¤ìŠ¤ë¡œ ì¡°ì¢…í–ˆë‹¤. ê°œë°œì ì…ì¥ì—ì„œëŠ” ìì—°ìŠ¤ëŸ¬ìš´ íë¦„ì´ë‹¤.
- ë°˜ë©´ì— `AppConfig`ê°€ ë“±ì¥í•œ ì´í›„ì— êµ¬í˜„ ê°ì²´ëŠ” ìì‹ ì˜ ë¡œì§ì„ ì‹¤í–‰í•˜ëŠ” ì—­í• ë§Œ ë‹´ë‹¹í•œë‹¤. í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì€ ì´ì œ `AppConfig`ê°€ ê°€ì ¸ê°„ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ì„œ `OrderServiceImpl`ì€ í•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤ë“¤ì„ í˜¸ì¶œí•˜ì§€ë§Œ **ì–´ë–¤ êµ¬í˜„ ê°ì²´ë“¤ì´ ì‹¤í–‰ë ì§€ ëª¨ë¥¸ë‹¤.**
- í”„ë¡œê·¸ë¨ì— ëŒ€í•œ ì œì–´ íë¦„ì— ëŒ€í•œ ê¶Œí•œì€ ëª¨ë‘ `AppConfig`ê°€ ê°€ì§€ê³  ìˆë‹¤. ì‹¬ì§€ì–´ `OrderServiceImpl`ë„ `AppConfig`ê°€ ìƒì„±í•œë‹¤. ê·¸ë¦¬ê³  `AppConfig`ëŠ” `OrderServiceImpl`ì´ ì•„ë‹Œ `OrderService`ì¸í„°í˜ì´ìŠ¤ì˜ ë‹¤ë¥¸ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰í•  ìˆ˜ ë„ ìˆë‹¤. ê·¸ëŸ° ì‚¬ì‹¤ë„ ëª¨ë¥¸ì²´ `OrderServiceImpl`ì€ ë¬µë¬µíˆ ìì‹ ì˜ ë¡œì§ì„ ì‹¤í–‰í•  ë¿ì´ë‹¤.
- ì´ë ‡ë“¯ í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì„ ì§ì ‘ ì œì–´í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì™¸ë¶€ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê²ƒì„ ì œì–´ì˜ ì—­ì „(IoC)ì´ë¼ í•œë‹¤.

### í”„ë ˆì„ì›Œí¬ vs ë¼ì´ë¸ŒëŸ¬ë¦¬

- í”„ë ˆì„ì›Œí¬ê°€ ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œë¥¼ ì œì–´í•˜ê³ , ëŒ€ì‹  ì‹¤í–‰í•˜ë©´ ê·¸ê²ƒì€ í”„ë ˆì„ì›Œí¬ (JUnit)
- ë°˜ë©´ì— ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œê°€ ì§ì ‘ ì œì–´ì˜ íë¦„ì„ ë‹´ë‹¹í•œë‹¤ë©´ ê·¸ê²ƒì€ í”„ë ˆì„ì›Œí¬ê°€ ì•„ë‹ˆë¼ ë¼ì´ë¸ŒëŸ¬ë¦¬

### ì˜ì¡´ê´€ê³„ ì£¼ì… DI(Dependency Injection)

- `OrderServiceImpl`ì€ `DiscountPolicy`ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•œë‹¤. ì‹¤ì œ ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ì‚¬ìš©ë ì§€ëŠ” ëª¨ë¦„
- ì˜ì¡´ê´€ê³„ëŠ” **â€œì •ì ì¸ í´ë˜ìŠ¤ ì˜ì¡´ ê´€ê³„ì™€, ì‹¤í–‰ ì‹œì ì— ê²°ì •ë˜ëŠ” ë™ì ì¸ ê°ì²´(ì¸ìŠ¤í„´ìŠ¤)ì˜ì¡´ ê´€ê³„â€** ë‘˜ì„ ë¶„ë¦¬í•´ì„œ ìƒê°í•´ì•¼ í•¨

### ì •ì ì¸ í´ë˜ìŠ¤ ì˜ì¡´ê´€ê³„

- í´ë˜ìŠ¤ê°€ ì‚¬ìš©í•˜ëŠ” import ì½”ë“œë§Œ ë³´ê³  ì˜ì¡´ê´€ê³„ë¥¼ ì‰½ê²Œ íŒë‹¨í•  ìˆ˜ ìˆë‹¤. ì •ì ì¸ ì˜ì¡´ê´€ê³„ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ì§€ ì•Šì•„ë„ ë¶„ì„í•  ìˆ˜ ìˆë‹¤. í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ì„ ë³´ì

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/72231f76-61ed-4567-8c9e-82bbe0e342fb/Untitled.png)

- `OrderServiceImpl`ì€ `MemberRepository`, `DiscountPolicy`ì— ì˜ì¡´í•œë‹¤
  ê·¸ëŸ°ë° ì´ëŸ¬í•œ **í´ë˜ìŠ¤ ì˜ì¡´ê´€ê³„ë§Œìœ¼ë¡œëŠ” ì‹¤ì œ ì–´ë–¤ ê°ì²´ê°€ `OrderServiceImpl`ì— ì£¼ì… ë ì§€ ì•Œ ìˆ˜ ì—†ìŒ**

### ë™ì ì¸ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ì˜ì¡´ ê´€ê³„

ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œì ì— ì‹¤ì œ ìƒì„±ëœ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡°ê°€ ì—°ê²°ëœ ì˜ì¡´ ê´€ê³„

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b269ca31-1283-484e-b707-86bf83b50a03/Untitled.png)

- **DI(ì˜ì¡´ê´€ê³„ ì£¼ì…)** : ì• í”Œë¦¬ì¼€ì´ì…˜ **ì‹¤í–‰ ì‹œì (ëŸ°íƒ€ì„)**ì— ì™¸ë¶€ì—ì„œ ì‹¤ì œ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•´ì„œ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì˜ ì‹¤ì œ ì˜ì¡´ê´€ê³„ê°€ ì—°ê²° ë˜ëŠ” ê²ƒ
- ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , ê·¸ ì°¸ì¡°ê°’ì„ ì „ë‹¬í•´ì„œ ì—°ê²°ëœë‹¤.
- ì˜ì¡´ê´€ê³„ ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ , í´ë¼ì´ì–¸íŠ¸ê°€ í˜¸ì¶œí•˜ëŠ” ëŒ€ìƒì˜ íƒ€ì… ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
- ì˜ì¡´ê´€ê³„ ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ ì •ì ì¸ í´ë˜ìŠ¤ ì˜ì¡´ê´€ê³„ë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ , ë™ì ì¸ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ì˜ì¡´ê´€ê³„ë¥¼ ì‰½ê²Œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

### IoC ì»¨í…Œì´ë„ˆ, DI ì»¨í…Œì´ë„ˆ

- `AppConfig`ì²˜ëŸ¼ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ë©´ì„œ ì˜ì¡´ê´€ê³„ë¥¼ ì—°ê²°í•´ ì£¼ëŠ” ê²ƒì„ **IoC ì»¨í…Œì´ë„ˆ ë˜ëŠ” DI ì»¨í…Œì´ë„ˆ**ë¼ í•¨
- ì˜ì¡´ê´€ê³„ ì£¼ì…ì— ì´ˆì ì„ ë§ì¶”ì–´ ìµœê·¼ì—ëŠ” ì£¼ë¡œ DI ì»¨í…Œì´ë„ˆ or ì–´ìƒ˜ë¸”ëŸ¬ or ì˜¤ë¸Œì íŠ¸ íŒ©í† ë¦¬ ë“±ìœ¼ë¡œ ë¶ˆë¦¼

## 9. ìŠ¤í”„ë§ìœ¼ë¡œ ì „í™˜í•˜ê¸°

### ğŸ—¨ï¸ AppConfig.java

```java
package hello.core;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPollicy;
import hello.core.discount.RateDiscountPolicy;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

/** AppConfig(ê¸°íšì)ë¥¼ í†µí•´ ê´€ì‹¬ì‚¬ ë¶„ë¦¬ */
// ìŠ¤í”„ë§ ì“°ê¸° ì „
//public class AppConfig {
//
////    // ì•„ë˜ ë°©ì‹ëŒ€ë¡œ í•˜ë©´, ì„¤ì • ì •ë³´ë¥¼ ë‹´ëŠ” ê³³ì´ë¯€ë¡œ ì—­í• ì— ë”°ë¥¸ êµ¬í˜„ì´ í•œëˆˆì— ë³´ì—¬ì•¼ í•˜ëŠ”ë° ê·¸ë ‡ì§€ ëª»í•¨
////    public MemberService memberService(){
////        return new MemberServiceImpl(new MemoryMemberRepository());
////    }
////
////    public OrderService orderService(){
////        return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPollicy());
////    }
//
//    /** ë¦¬íŒ©í† ë§ (Ctrl + Alt + M) */
//    // ê²°ê³¼
//    // 1. new MemoryMemberRepository() ì´ ë¶€ë¶„ì´ ì¤‘ë³µ ì œê±° (ë‹¤ë¥¸ êµ¬í˜„ì²´ë¡œ ë³€ê²½í•  ë•Œ í•œ ë¶€ë¶„ë§Œ ë³€ê²½í•˜ë©´ ë¨)
//    // 2. AppConfig ë¥¼ ë³´ë©´ ì—­í• ê³¼ êµ¬í˜„ í´ë˜ìŠ¤ê°€ í•œëˆˆì— ë“¤ì–´ì˜´ (ì „ì²´ êµ¬ì„± ë¹ ë¥´ê²Œ íŒŒì•… ê°€ëŠ¥)
//    public MemberService memberService(){
//        return new MemberServiceImpl(memberRepository());
//    }
//
//    public MemoryMemberRepository memberRepository() {
//        return new MemoryMemberRepository();
//    }
//
//    public OrderService orderService(){
//        return new OrderServiceImpl(memberRepository(), discountPolicy());
//    }
//
//    public DiscountPolicy discountPolicy(){
////        return new FixDiscountPollicy();
//        return new RateDiscountPolicy();
//    }
//}

/** ìŠ¤í”„ë§ì´ Beanì„ ë“±ë¡í•˜ëŠ” ë°©ë²• 2 : íŒ©í† ë¦¬ ë©”ì†Œë“œ ì´ìš© */
@Configuration
public class AppConfig {
    @Bean
    public MemberService memberService(){
        return new MemberServiceImpl(memberRepository());
    }
    @Bean
    public MemoryMemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }
    @Bean
    public OrderService orderService(){
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }
    @Bean
    public DiscountPolicy discountPolicy(){
//        return new FixDiscountPollicy();
        return new RateDiscountPolicy();
    }
}
```

1. AppConfigì— ì„¤ì •ì„ êµ¬ì„±í•œë‹¤ëŠ” ëœ»ì˜ @Configuration ì„ ë¶™ì—¬ì¤€ë‹¤.
2. ê° ë©”ì„œë“œì— @Bean ì„ ë¶™ì—¬ì¤€ë‹¤. (ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡)

### ğŸ—¨ï¸ MemberApp.java

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class MemberApp {

    // psvm
    public static void main(String[] args) {
//        Spring ì‚¬ìš© ì „
//        AppConfig appConfig = new AppConfig();
//        MemberService memberService = appConfig.memberService();

        // Spring ì‚¬ìš©
        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
        MemberService memberService = applicationContext.getBean("memberService", MemberService.class);

        Member member = new Member(1L, "memberA", Grade.VIP);
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("new member : " + member.getName());
        System.out.println("findMember : " + findMember.getName());
    }
}
```

### ğŸ—¨ï¸ OrderApp.java

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.order.Order;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class OrderApp {

    public static void main(String[] args) {

        // MemberService memberService = new MemberServiceImpl(memberRepository);
        // OrderService orderService = new OrderServiceImpl(memberRepository, discountPolicy);

//        Spring ì‚¬ìš© ì „
//        AppConfig appConfig = new AppConfig();
//        MemberService memberService = appConfig.memberService();
//        OrderService orderService = appConfig.orderService();

        // Spring ì‚¬ìš©
        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
        MemberService memberService = applicationContext.getBean("memberService", MemberService.class);
        OrderService orderService = applicationContext.getBean("orderService", OrderService.class);

        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);
        System.out.println("order = " + order);
    }
}
```

â‡’ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ê°ì²´ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ê³ , ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ìŠ¤í”„ë§ ë¹ˆì„ ì°¾ì•„ì„œ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½

### ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ

- `ApplicationContext`
- `@Configuration` ì´ ë¶™ì€ AppConfigë¥¼ ì„¤ì •(êµ¬ì„±) ì •ë³´ë¡œ ì‚¬ìš©í•¨
- ì—¬ê¸°ì„œ `@Bean`ì´ ì íŒ ë©”ì„œë“œë¥¼ **ëª¨ë‘ í˜¸ì¶œí•´ì„œ ë°˜í™˜ëœ ê°ì²´ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡**
  ì—¬ê¸°ì„œ ë“±ë¡ëœ ê°ì²´ë¥¼ ìŠ¤í”„ë§ ë¹ˆì´ë¼ í•¨
- ìŠ¤í”„ë§ ë¹ˆì€ `applicationContext.getBean(ì´ë¦„, class)` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ ì°¾ì„ ìˆ˜ ìˆë‹¤.
- ìŠ¤í”„ë§ ë¹ˆì€ `@Bean`ì´ ë¶™ì€ ë©”ì„œë“œì˜ ëª…ì„ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•¨ (`memberService` , `orderService` )
