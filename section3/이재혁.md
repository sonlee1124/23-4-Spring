## í”„ë¡œì íŠ¸ ìƒì„±

- ìŠ¤í”„ë§ ë¶€íŠ¸ ìŠ¤íƒ€í„° ì‚¬ì´íŠ¸ì—ì„œ ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ ìƒì„±
    - https://start.spring.io
- file/settings â†’ preference â†’ gradleê²€ìƒ‰ â†’ build and run using & test ëª¨ë‘ intellijë¡œ ì„¤ì •

## ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ ì„¤ê³„

- íšŒì›
    - íšŒì›ê°€ì…, ì¡°íšŒ ê¸°ëŠ¥
    - íšŒì› ë“±ê¸‰: ì¼ë°˜, VIP
    - íšŒì› ë°ì´í„°ëŠ” ìì²´ DBë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆê³ , ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ì—°ë™ë„ ê°€ëŠ¥(ë¯¸í™•ì •)
- ì£¼ë¬¸ê³¼ í• ì¸ ì •ì±…
    - íšŒì›ì€ ìƒí’ˆì„ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤
    - íšŒì› ë“±ê¸‰ì— ë”°ë¼ í• ì¸ ì •ì±…ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤
    - í• ì¸ì •ì±…ì€ ë³€ê²½ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤(ë¯¸í™•ì •)

ì •ì±…ì´ ê²°ì • ë  ë•Œ ê¹Œì§€ ê°œë°œì„ ë¬´ê¸°í•œ ê¸°ë‹¤ë¦´ ìˆ˜ ì—†ë‹¤. ê°ì²´ì§€í–¥ ì„¤ê³„ ë°©ë²•ìœ¼ë¡œ ì‹œì‘í•œë‹¤

ì¸í„°í˜ì´ìŠ¤ë¥¼ ì„¤ê³„í•˜ë©´ ëœë‹¤

## íšŒì› ë„ë©”ì¸ ì„¤ê³„

- íšŒì› ë„ë©”ì¸ ìš”êµ¬ì‚¬í•­
    - íšŒì›ì„ ê°€ì…í•˜ê³  ì¡°íšŒí•  ìˆ˜ ìˆë‹¤
    - íšŒì›ì€ ì¼ë°˜ê³¼ VIP ë“±ê¸‰ì´ ìˆë‹¤
    - íšŒì› ë°ì´í„°ëŠ” ìì²´ DBë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆê³ , ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ì—°ë™ë„ ê°€ëŠ¥(ë¯¸í™•ì •)
- íšŒì› ë„ë©”ì¸ í˜‘ë ¥ ê´€ê³„
    - í´ë¼ì´ì–¸íŠ¸ â†’ íšŒì›ì„œë¹„ìŠ¤ â†’ íšŒì› ì €ì¥ì†Œ(ë©”ëª¨ë¦¬ íšŒì› ì €ì¥ì†Œ, DB, ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™)
- êµ¬í˜„ ë‹¨ê³„
    - íšŒì› í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨
    - MemberService ì¸í„°í˜ì´ìŠ¤ ìƒì„±
    - MemberServiceImpl (íšŒì› ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„ í•  ê²ƒì€ í•˜ë‚˜ ë°–ì— ì—†ìœ¼ë¯€ë¡œ í•˜ë‚˜ë§Œ êµ¬í˜„ì²´ ìƒì„±)
    - MemberRepository ì¸í„°í˜ì´ìŠ¤ ìƒì„±
    - MemoryMemberRepository, DbMemberRepository, ì™¸ë¶€MemberRepository ë“±
- íšŒì› ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨
    - í´ë¼ì´ì–¸íŠ¸ â†’ íšŒì› ì„œë¹„ìŠ¤(MemberServiceImpl) â†’ ë©”ëª¨ë¦¬ íšŒì› ì €ì¥ì†Œ

íšŒì›ë“±ê¸‰

```java
package hello.core.member;

public enum Grade {
    BASIC,
    VIP
}
```

íšŒì› ì—”í‹°í‹°

```java
package hello.core.member;

public class Member {

    private Long id;
    private String name;
    private Grade grade;

    public Member(Long id, String name, Grade grade) {
        this.id = id;
        this.name = name;
        this.grade = grade;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Grade getGrade() {
        return grade;
    }

    public void setGrade(Grade grade) {
        this.grade = grade;
    }

}
```

íšŒì› ì €ì¥ì†Œ

```java
package hello.core.member;

public interface MemberRepository {

    void save(Member member);

    Member findById(Long memberId);
}
```

ë©”ëª¨ë¦¬ íšŒì› ì €ì¥ì†Œ êµ¬í˜„ì²´

```java
package hello.core.member;

import java.util.HashMap;
import java.util.Map;

public class MemoryMemberRepository implements MemberRepository {

    private static Map<Long, Member> store = new HashMap<>();

    @Override
    public void save(Member member) {
        store.put(member.getId(), member);
    }

    @Override
    public Member findById(Long memberId) {
        return store.get(memberId);
    }
}
```

íšŒì› ì„œë¹„ìŠ¤

íšŒì› ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤

```java
package hello.core.member;

public interface MemberService {

    void join(Member member);

    Member findMember(Long memberId);
}
```

íšŒì› ì„œë¹„ìŠ¤ êµ¬í˜„ì²´

```java
package hello.core.member;

public class MemberServiceImpl implements MemberService {

    private final MemberRepository memberRepository = new MemoryMemberRepository();

    @Override
    public void join(Member member) {
        memberRepository.save(member);
    }

    @Override
    public Member findMember(Long memberId) {
        return memberRepository.findById(memberId);
    }
}
```

## íšŒì› ë„ë©”ì¸ ì‹¤í–‰ê³¼ í…ŒìŠ¤íŠ¸

<aside>
ğŸ’¡ ë„ë©”ì¸ì´ë€? ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ëŒ€ìƒì´ ë˜ëŠ” ì˜ì—­. ex) íƒì‹œ ì•±ì„ ë§Œë“¤ ë•Œ íƒì‹œ í˜¸ì¶œ, íƒ‘ìŠ¹, ìš”ê¸ˆ ì§€ë¶ˆì˜ ì „ ê³¼ì •ì´ ë„ë©”ì¸ì´ ëœë‹¤.

</aside>

íšŒì› ë„ë©”ì¸ - íšŒì› ê°€ì… main

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

public class MemberApp {

    public static void main(String[] args) {
        MemberService memberService = new MemberServiceImpl();
        Member member = new Member(1L, "memberA", Grade.VIP);
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("new member = " + member.getName());
        System.out.println("find Member = " + findMember.getName());

    }
}
```

JUnit í…ŒìŠ¤íŠ¸ë¥¼ í™œìš©í•˜ëŠ” ê²ƒì´ ì¢‹ì€ í…ŒìŠ¤íŠ¸ ë°©ë²•

íšŒì› ë„ë©”ì¸ - íšŒì› ê°€ì… í…ŒìŠ¤íŠ¸

```java
package hello.core.member;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.*;
import static org.junit.jupiter.api.Assertions.*;

class MemberServiceTest {

    MemberService memberService = new MemberServiceImpl();

    @Test
    void join() {
        //given
        Member member = new Member(1L, "memberA", Grade.VIP);

        //when
        memberService.join(member);
        Member findMember = memberService.findMember(1L);

        //then
        assertThat(member).isEqualTo(findMember);

    }
}
```

- íšŒì› ë„ë©”ì¸ ì„¤ê³„ì˜ ë¬¸ì œì 
    - ì˜ì¡´ê´€ê³„ê°€ ì¸í„°í˜ì´ìŠ¤ ë¿ë§Œ ì•„ë‹ˆë¼ êµ¬í˜„ê¹Œì§€ ëª¨ë‘ ì˜ì¡´í•˜ëŠ” ë¬¸ì œì ì´ ìˆë‹¤

## ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ì„¤ê³„

- ì£¼ë¬¸ ë„ë©”ì¸ í˜‘ë ¥, ì—­í• , ì±…ì„
    - ì£¼ë¬¸ìƒì„±: í´ë¼ì´ì–¸íŠ¸ëŠ” ì£¼ë¬¸ ì„œë¹„ìŠ¤ì— ì£¼ë¬¸ ìƒì„±ì„ ìš”ì²­í•œë‹¤
    - íšŒì›ì¡°íšŒ: í• ì¸ì„ ìœ„í•´ íšŒì› ë“±ê¸‰ì´ í•„ìš”í•˜ë‹¤. ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” íšŒì› ì €ì¥ì†Œì—ì„œ íšŒì›ì„ ì¡°íšŒ
    - í• ì¸ì ìš©
    - ì£¼ë¬¸ê²°ê³¼ ë°˜í™˜

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9ea9d2dc-8def-4f71-ac3d-693d5c3aa54a/Untitled.png)

- ì£¼ë¬¸ ë„ë©”ì¸ ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨
    - í´ë¼ì´ì–¸íŠ¸ â†’ ì£¼ë¬¸ ì„œë¹„ìŠ¤ êµ¬í˜„ì²´ â†’ ë©”ëª¨ë¦¬ íšŒì› ì €ì¥ì†Œ(DB), ì •ì•¡(ì •ë¥ ) í• ì¸ ì •ì±…
        - â‡’ í˜‘ë ¥ê´€ê³„ë¥¼ ê·¸ëŒ€ë¡œ ì¬ì‚¬ìš© ê°€ëŠ¥

## ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ê°œë°œ

í• ì¸ ì •ì±… ì¸í„°í˜ì´ìŠ¤

```java
package hello.core.discount;

import hello.core.member.Member;

public interface DiscountPolicy {

    /*
        @return í• ì¸ ëŒ€ìƒ ê¸ˆì•¡
     */

    int discount(Member member, int price);
}
```

ì •ì•¡ í• ì¸ ì •ì±… êµ¬í˜„ì²´

```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;

public class FixDiscountPolicy implements DiscountPolicy {

    private int discountFixAmount = 1000; //1000ì› í• ì¸

    @Override
    public int discount(Member member, int price) {
        if (member.getGrade() == Grade.VIP) {
            return discountFixAmount;
        } else {
            return 0;
        }
    }
}
```

ì£¼ë¬¸ ì—”í‹°í‹°

```java
package hello.core.order;

public class Order {

    private Long memberId;
    private String itemName;
    private int itemPrice;
    private int discountPrice;

    public Order(Long memberId, String itemName, int itemPrice, int discountPrice) {
        this.memberId = memberId;
        this.itemName = itemName;
        this.itemPrice = itemPrice;
        this.discountPrice = discountPrice;
    }

    public int calculatePrice() {
        return itemPrice - discountPrice;
    }

    public Long getMemberId() {
        return memberId;
    }

    public void setMemberId(Long memberId) {
        this.memberId = memberId;
    }

    public String getItemName() {
        return itemName;
    }

    public void setItemName(String itemName) {
        this.itemName = itemName;
    }

    public int getItemPrice() {
        return itemPrice;
    }

    public void setItemPrice(int itemPrice) {
        this.itemPrice = itemPrice;
    }

    public int getDiscountPrice() {
        return discountPrice;
    }

    public void setDiscountPrice(int discountPrice) {
        this.discountPrice = discountPrice;
    }

    @Override
    public String toString() {
        return "Order{" +
                "memberId=" + memberId +
                ", itemName='" + itemName + '\'' +
                ", itemPrice=" + itemPrice +
                ", discountPrice=" + discountPrice +
                '}';
    }
}
```

ì£¼ë¬¸ ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤

```java
package hello.core.order;

public interface OrderService {
    Order createOrder(Long memberId, String itemName, int itemPrice);

}
```

ì£¼ë¬¸ ì„œë¹„ìŠ¤ êµ¬í˜„ì²´

```java
package hello.core.order;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.member.Member;
import hello.core.member.MemberRepository;
import hello.core.member.MemoryMemberRepository;

public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);

        return new Order(memberId, itemName, itemPrice, discountPrice);
    }

}
```

- ì£¼ë¬¸ ìƒì„± ìš”ì²­ì´ ì˜¤ë©´, íšŒì› ì •ë³´ë¥¼ ì¡°íšŒí•˜ê³ , í• ì¸ ì •ì±…ì„ ì ìš©í•œ ë‹¤ìŒ ì£¼ë¬¸ ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ë°˜í™˜í•œë‹¤. ë©”ëª¨ë¦¬ íšŒì› ë¦¬í¬ì§€í† ë¦¬ì™€, ê³ ì • ê¸ˆì•¡ í• ì¸ ì •ì±…ì„ êµ¬í˜„ì²´ë¡œ ìƒì„±í•œë‹¤.

## ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ì‹¤í–‰ê³¼ í…ŒìŠ¤íŠ¸

ì£¼ë¬¸ê³¼ í• ì¸ ì •ì±… ì‹¤í–‰

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.order.Order;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

public class OrderApp {

    public static void main(String[] args) {
        MemberService memberService = new MemberServiceImpl();
        OrderService orderService = new OrderServiceImpl();

        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);

        System.out.println("order = " + order);
//        System.out.println("order = " + order.calculatePrice());
    }
}
```

ì£¼ë¬¸ê³¼ í• ì¸ ì •ì±… í…ŒìŠ¤íŠ¸

```java
package hello.core.order;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

class OrderServiceTest {

    MemberService memberService = new MemberServiceImpl();
    OrderService orderService = new OrderServiceImpl();

    @Test
    void createOrder() {
        Long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);
        Assertions.assertThat(order.getDiscountPrice()).isEqualTo(1000);

    }

}
```